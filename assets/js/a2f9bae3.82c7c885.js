"use strict";(self.webpackChunkapify_docs_v2=self.webpackChunkapify_docs_v2||[]).push([[3957],{3905:(e,t,r)=>{r.d(t,{Zo:()=>p,kt:()=>m});var n=r(67294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var l=n.createContext({}),c=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},p=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=c(r),m=a,y=u["".concat(l,".").concat(m)]||u[m]||d[m]||o;return r?n.createElement(y,i(i({ref:t},p),{},{components:r})):n.createElement(y,i({ref:t},p))}));function m(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=r.length,i=new Array(o);i[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var c=2;c<o;c++)i[c]=r[c];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}u.displayName="MDXCreateElement"},10267:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>p,contentTitle:()=>l,default:()=>m,frontMatter:()=>s,metadata:()=>c,toc:()=>d});var n=r(87462),a=r(63366),o=(r(67294),r(3905)),i=["components"],s={title:"How to add external libraries to Web Scraper",description:"Web Scraper does not provide an option to load external JavaScript libraries. Fortunately, there's an easy way to do it. Learn how.",sidebar_position:15.7,slug:"/node-js/add-external-libraries-web-scraper"},l=void 0,c={unversionedId:"tutorials/node_js/add_external_libraries_web_scraper",id:"tutorials/node_js/add_external_libraries_web_scraper",title:"How to add external libraries to Web Scraper",description:"Web Scraper does not provide an option to load external JavaScript libraries. Fortunately, there's an easy way to do it. Learn how.",source:"@site/sources/academy/tutorials/node_js/add_external_libraries_web_scraper.md",sourceDirName:"tutorials/node_js",slug:"/node-js/add-external-libraries-web-scraper",permalink:"/academy/node-js/add-external-libraries-web-scraper",draft:!1,editUrl:"https://github.com/apify/apify-docs-v2/edit/master/sources/academy/tutorials/node_js/add_external_libraries_web_scraper.md",tags:[],version:"current",lastUpdatedBy:"Franti\u0161ek Nesveda",lastUpdatedAt:1676072095,formattedLastUpdatedAt:"Feb 10, 2023",sidebarPosition:15.7,frontMatter:{title:"How to add external libraries to Web Scraper",description:"Web Scraper does not provide an option to load external JavaScript libraries. Fortunately, there's an easy way to do it. Learn how.",sidebar_position:15.7,slug:"/node-js/add-external-libraries-web-scraper"},sidebar:"academy",previous:{title:"Processing the same page multiple times with different setups in Web Scraper",permalink:"/academy/node-js/processing-multiple-pages-web-scraper"},next:{title:"How to save screenshots from puppeteer",permalink:"/academy/node-js/how-to-save-screenshots-puppeteer"}},p={},d=[{value:"Injecting Moment.js",id:"injecting-momentjs",level:2},{value:"Injecting a library with plain JavaScript",id:"injecting-a-library-with-plain-javascript",level:2},{value:"Injecting a library using jQuery",id:"injecting-a-library-using-jquery",level:2},{value:"Dealing with errors",id:"dealing-with-errors",level:2}],u={toc:d};function m(e){var t=e.components,r=(0,a.Z)(e,i);return(0,o.kt)("wrapper",(0,n.Z)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Sometimes you need to use some extra JavaScript in your ",(0,o.kt)("a",{parentName:"p",href:"https://apify.com/apify/web-scraper",target:"_blank",rel:"noopener"},"Web Scraper")," page functions. Whether it is to work with dates and times using ",(0,o.kt)("a",{parentName:"p",href:"https://momentjs.com/",target:"_blank",rel:"noopener"},"Moment.js"),", or to manipulate the DOM using ",(0,o.kt)("a",{parentName:"p",href:"https://jquery.com/",target:"_blank",rel:"noopener"},"jQuery"),", libraries save precious time and make your code more concise and readable. Web Scraper already provides an easy way to add jQuery to your page functions. All you need to do is to check the Inject jQuery input option. There's also the option to Inject Underscore, a popular helper function library."),(0,o.kt)("p",null,"In this tutorial, we'll learn how to inject any JavaScript library into your page functions, with the only limitation being that the library needs to be available somewhere on the internet as a downloadable file (typically a CDN)."),(0,o.kt)("h2",{id:"injecting-momentjs"},"Injecting Moment.js"),(0,o.kt)("p",null,"Moment.js is a very popular library for working with date and time. It helps you with the parsing, manipulation, and formatting of datetime values in multiple locales and has become the de-facto standard for this kind of work in JavaScript."),(0,o.kt)("p",null,"To inject Moment.js into our page function (or any other library using the same method), we first need to find a link to download it from. We can easily find it in ",(0,o.kt)("a",{parentName:"p",href:"https://momentjs.com/docs/#/use-it/browser/",target:"_blank",rel:"noopener"},"Moment.js' documentation")," under the CDN links."),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("a",{parentName:"p",href:"https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js",target:"_blank",rel:"noopener"},"https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"))),(0,o.kt)("p",null,"Now we have two options. Inject the library using plain JavaScript, or if you prefer working with jQuery, use a jQuery helper."),(0,o.kt)("h2",{id:"injecting-a-library-with-plain-javascript"},"Injecting a library with plain JavaScript"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'async function pageFunction(context) {\\\n\xa0 \xa0 const libraryUrl = "https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js";\n\n// Inject Moment.js\\\n\xa0 \xa0 await new Promise((resolve) => {\\\n\xa0 \xa0 \xa0 \xa0 const script = document.createElement("script");\\\n\xa0 \xa0 \xa0 \xa0 script.src = libraryUrl;\\\n\xa0 \xa0 \xa0 \xa0 script.addEventListener(\'load\', resolve);\\\n\xa0 \xa0 \xa0 \xa0 document.body.append(script);\\\n\xa0 \xa0 });\n\n// Confirm that it works.\\\n\xa0 \xa0 const now = moment().format("ddd, hA");\\\n\xa0 \xa0 context.log.info("NOW: " + now);\\\n}\n')),(0,o.kt)("p",null,"We're creating a script element in the page's DOM and waiting for the script to load. Afterwards, we just confirm that the library has been successfully loaded by using one of its functions."),(0,o.kt)("h2",{id:"injecting-a-library-using-jquery"},"Injecting a library using jQuery"),(0,o.kt)("p",null,"After you select the Inject jQuery input option, jQuery will become available in your page function as ",(0,o.kt)("inlineCode",{parentName:"p"},"context.jQuery")," ."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'async function pageFunction(context) {\\\n\xa0 \xa0 const libraryUrl = "https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js";\n\nconst $ = context.jQuery;\n\n// Inject Moment.js\\\n\xa0 \xa0 await $.getScript(libraryUrl);\n\n// Confirm that it works.\\\n\xa0 \xa0 const now = moment().format("ddd, hA");\\\n\xa0 \xa0 context.log.info("NOW: " + now);\\\n}\n')),(0,o.kt)("p",null,"With jQuery, we're simply using the ",(0,o.kt)("inlineCode",{parentName:"p"},"$.getScript()")," helper to fetch the script for us and wait for it to load."),(0,o.kt)("h2",{id:"dealing-with-errors"},"Dealing with errors"),(0,o.kt)("p",null,"Some websites employ security measures that disallow loading external scripts within their pages. Luckily, those measures can be easily overridden with Web Scraper. If you are encountering errors saying that your library cannot be loaded due to a security policy, just select the Ignore CORS and CSP input option at the very bottom of Web Scraper input and the errors should go away."),(0,o.kt)("p",null,"Happy scraping!"))}m.isMDXComponent=!0}}]);