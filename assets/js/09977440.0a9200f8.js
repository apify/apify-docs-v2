"use strict";(self.webpackChunkapify_docs_v2=self.webpackChunkapify_docs_v2||[]).push([[1293],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>g});var o=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=o.createContext({}),c=function(e){var t=o.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=c(e.components);return o.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},d=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=c(n),g=r,y=d["".concat(l,".").concat(g)]||d[g]||p[g]||a;return n?o.createElement(y,i(i({ref:t},u),{},{components:n})):o.createElement(y,i({ref:t},u))}));function g(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var c=2;c<a;c++)i[c]=n[c];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}d.displayName="MDXCreateElement"},51600:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>l,default:()=>g,frontMatter:()=>s,metadata:()=>c,toc:()=>p});var o=n(87462),r=n(63366),a=(n(67294),n(3905)),i=["components"],s={title:"Debugging your Web Scraper pageFunction in browser's console",description:"Test your Page Function's code directly in your browser's console",sidebar_position:16.3,slug:"/node-js/debugging-web-scraper"},l=void 0,c={unversionedId:"tutorials/node_js/debugging_web_scraper",id:"tutorials/node_js/debugging_web_scraper",title:"Debugging your Web Scraper pageFunction in browser's console",description:"Test your Page Function's code directly in your browser's console",source:"@site/sources/academy/tutorials/node_js/debugging_web_scraper.md",sourceDirName:"tutorials/node_js",slug:"/node-js/debugging-web-scraper",permalink:"/academy/node-js/debugging-web-scraper",draft:!1,editUrl:"https://github.com/apify/apify-docs-v2/edit/master/sources/academy/tutorials/node_js/debugging_web_scraper.md",tags:[],version:"current",lastUpdatedBy:"Franti\u0161ek Nesveda",lastUpdatedAt:1676071022,formattedLastUpdatedAt:"Feb 10, 2023",sidebarPosition:16.3,frontMatter:{title:"Debugging your Web Scraper pageFunction in browser's console",description:"Test your Page Function's code directly in your browser's console",sidebar_position:16.3,slug:"/node-js/debugging-web-scraper"},sidebar:"academy",previous:{title:"Block requests in Puppeteer",permalink:"/academy/node-js/block-requests-puppeteer"},next:{title:"Avoid EACCES error in actor builds with a custom Dockerfile",permalink:"/academy/node-js/avoid-eacces-error-in-actor-builds"}},u={},p=[{value:"Pasting and running a small code snippet",id:"pasting-and-running-a-small-code-snippet",level:2},{value:"Pasting and running a full pageFunction",id:"pasting-and-running-a-full-pagefunction",level:2}],d={toc:p};function g(e){var t=e.components,n=(0,r.Z)(e,i);return(0,a.kt)("wrapper",(0,o.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"A lot of beginners struggle through trial and error while scraping a simple site. They write some code that might work, press the run button, see that error happened and they continue writing more code that might work but probably won't. This is extremely inefficient and gets tedious really fast."),(0,a.kt)("p",null,"What beginners are missing are simple tools and tricks to get things done quickly. One of these wow tricks is the option to run the JavaScript code directly in your browser."),(0,a.kt)("p",null,"Pressing F12 while browsing with Chrome, Firefox, or other popular browsers opens up the browser console, the magic toolbox of any web developer. The console allows you to run a code in the context of the website you are in. Don't worry, you cannot mess the site up (well, unless you start doing really nasty tricks) as the page content is downloaded on your computer and any change is only local to your PC."),(0,a.kt)("h1",{id:"running-code-in-a-browser-console"},"Running code in a browser console"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Test your Page Function's code directly in your browser's console")),(0,a.kt)("hr",null),(0,a.kt)("p",null,"First, you need to inject jQuery. You can try to paste and run this snippet."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"var jq = document.createElement('script');\njq.src = \"https://ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js\";\ndocument.getElementsByTagName('head')[0].appendChild(jq);\n")),(0,a.kt)("p",null,"If that doesn't work because of CORS violation, you can install ",(0,a.kt)("a",{parentName:"p",href:"https://chrome.google.com/webstore/detail/jquery-inject/iibfbhlfimdnkinkcenncoeejnmpemof",target:"_blank",rel:"noopener"},"this extension")," that injects jQuery on a button click."),(0,a.kt)("p",null,"There are 2 main ways how to test a pageFunction code in your console:"),(0,a.kt)("h2",{id:"pasting-and-running-a-small-code-snippet"},"Pasting and running a small code snippet"),(0,a.kt)("p",null,"Usually, you don't need to paste in the whole pageFunction as you can simply isolate the critical part of the code you are trying to debug. You will need to remove any references to the ",(0,a.kt)("inlineCode",{parentName:"p"},"context")," object and its properties like ",(0,a.kt)("inlineCode",{parentName:"p"},"request")," and the final return statement but otherwise, the code should work 1:1."),(0,a.kt)("p",null,"I will also usually remove ",(0,a.kt)("inlineCode",{parentName:"p"},"const")," declarations on the top level variables. This helps you to run the same code many times over without needing to restart the console (you cannot declare constants more than once). So my declaration will change from:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"const results = [];\n// Scraping something to fill the results\n")),(0,a.kt)("p",null,"into"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"results = [];\n")),(0,a.kt)("p",null,"You can easily get all information you need by running a small snippet of your pageFunction like this"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"results = [];\n$('.my-list-item').each((i, el) => {\n results.push({\n title: $(el).find('.title').text().trim(),\n // other fields\n })\n})\n")),(0,a.kt)("p",null,"Now the ",(0,a.kt)("inlineCode",{parentName:"p"},"results")," variable stays on the page and you can do whatever you wish with it. Usually, simply log it to analyze if your scraping code is correct. Writing a single expression will also log it in a browser console."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"results\n// Will log a nicely formatted [{ title: 'my-article-1'}, { title: 'my-article-2'}] etc.\n")),(0,a.kt)("h2",{id:"pasting-and-running-a-full-pagefunction"},"Pasting and running a full pageFunction"),(0,a.kt)("p",null,"If you don't want to deal with copy/pasting a proper snippet, you can always paste the whole pageFunction. You will just have to mock the context object when calling it. If you use some advanced tricks, this might not work but in most cases copy pasting this code should do it. This code is only for debugging your Page Function for a particular page. It does not crawl the website and the output is not saved anywhere."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"async function pageFunction(context) {\n\xa0 /_\n\xa0 \xa0 this is your pageFunction\n\xa0 _/\n}\n// Now you will call it with mocked context\npageFunction ({\n\xa0 request: {\n\xa0 \xa0 url: window.location.href,\n userData: { label: 'paste-a-label-if-you-use-one'}\n\xa0 },\n\xa0 waitFor: async function (ms) {console.log('(waitFor)'); await new Promise(res) => setTimeout(res, ms)},\n\xa0 enqueueRequest: function () {console.log('(enqueuePage)', arguments)},\n\xa0 skipLinks: function () {console.log('(skipLinks)', arguments)},\n\xa0 jQuery: $\n});\n")),(0,a.kt)("p",null,"Happy debugging!"))}g.isMDXComponent=!0}}]);