<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-tutorials/scrape_paginated_sites">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Scrape paginated sites | Apify Docs v2</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs-v2.apify.com/img/apify_og_SDK.png"><meta data-rh="true" name="twitter:image" content="https://docs-v2.apify.com/img/apify_og_SDK.png"><meta data-rh="true" property="og:url" content="https://docs-v2.apify.com/platform/tutorials/scrape-paginated-sites"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Scrape paginated sites | Apify Docs v2"><meta data-rh="true" name="description" content="Learn how to extract all of a website&#x27;s listings even if they limit the number of results pages. See code examples for setting up your scraper."><meta data-rh="true" property="og:description" content="Learn how to extract all of a website&#x27;s listings even if they limit the number of results pages. See code examples for setting up your scraper."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs-v2.apify.com/platform/tutorials/scrape-paginated-sites"><link data-rh="true" rel="alternate" href="https://docs-v2.apify.com/platform/tutorials/scrape-paginated-sites" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs-v2.apify.com/platform/tutorials/scrape-paginated-sites" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://N8EOCSBQGH-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Apify Docs v2" href="/opensearch.xml">



<script src="/js/custom.js"></script><link rel="stylesheet" href="/assets/css/styles.7b4bca8b.css">
<link rel="preload" href="/assets/js/runtime~main.54bcee31.js" as="script">
<link rel="preload" href="/assets/js/main.8492f025.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbarHideable_m1mJ"><div style="width:100%;height:100%;align-items:center;display:flex;flex-direction:column"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://docs-v2.apify.com" target="_self" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/apify_sdk.svg" alt="" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/apify_sdk_white.svg" alt="" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Apify Docs</b></a><a href="https://docs-v2.apify.com/academy" target="_self" rel="dofollow" class="navbar__item navbar__link">Academy</a><a href="https://docs-v2.apify.com/platform" target="_self" rel="dofollow" class="navbar__item navbar__link navbar__link--active">Platform</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__item navbar__link">API</a><ul class="dropdown__menu"><li><a href="https://docs.apify.com/api/v2" target="_blank" rel="noopener noreferrer" class="dropdown__link">Reference</a></li><li><a href="https://docs-v2.apify.com/client-js/" target="_self" rel="dofollow" class="dropdown__link">Client for JavaScript</a></li><li><a href="https://docs-v2.apify.com/client-python/" target="_self" rel="dofollow" class="dropdown__link">Client for Python</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__item navbar__link">SDK</a><ul class="dropdown__menu"><li><a href="https://docs-v2.apify.com/sdk-js/" target="_self" rel="dofollow" class="dropdown__link">SDK for JavaScript</a></li><li><a href="https://docs-v2.apify.com/sdk-python/" target="_self" rel="dofollow" class="dropdown__link">SDK for Python</a></li></ul></div><a href="https://docs-v2.apify.com/cli/" target="_self" rel="dofollow" class="navbar__item navbar__link">CLI</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Open Source</a><ul class="dropdown__menu"><li><a href="https://crawlee.dev" target="_blank" rel="dofollow" class="dropdown__link">Crawlee</a></li><li><a href="https://github.com/apify/got-scraping" target="_blank" rel="noopener noreferrer" class="dropdown__link">Got Scraping</a></li><li><a href="https://github.com/apify/fingerprint-suite" target="_blank" rel="noopener noreferrer" class="dropdown__link">Fingerprint Suite</a></li><li><a href="https://github.com/apify" target="_blank" rel="noopener noreferrer" class="dropdown__link">See our GitHub</a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="toggle_cGDO colorModeToggle_VSaW"><button class="clean-btn toggleButton_AJwv toggleButtonDisabled_OaNe" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><span><svg viewBox="0 0 13 12" fill="none" xmlns="http://www.w3.org/2000/svg" width="14" height="14" class="lightToggleIcon_SoDp"><g clip-path="url(#clip0_833_8168)"><path d="M6.59998 8.49999C7.98069 8.49999 9.09998 7.3807 9.09998 5.99999C9.09998 4.61928 7.98069 3.49999 6.59998 3.49999C5.21926 3.49999 4.09998 4.61928 4.09998 5.99999C4.09998 7.3807 5.21926 8.49999 6.59998 8.49999Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M6.59985 0.5V1.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M6.59985 10.5V11.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M2.7099 2.11L3.4199 2.82" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M9.77991 9.17999L10.4899 9.88999" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M1.09998 6H2.09998" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M11.0999 6H12.0999" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M2.7099 9.88999L3.4199 9.17999" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M9.77991 2.82L10.4899 2.11" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></g><defs><clipPath id="clip0_833_8168"><rect width="12" height="12" fill="white" transform="translate(0.599976)"></rect></clipPath></defs></svg><svg viewBox="0 0 13 12" width="14" height="14" class="darkToggleIcon_sLik"><path d="M10.7001 6.39501C10.6215 7.24611 10.3021 8.05721 9.77927 8.7334C9.25646 9.40959 8.55189 9.92291 7.748 10.2133C6.9441 10.5036 6.07414 10.5591 5.2399 10.3731C4.40565 10.187 3.64164 9.76728 3.03726 9.1629C2.43287 8.55851 2.01312 7.7945 1.8271 6.96026C1.64108 6.12602 1.6965 5.25605 1.98688 4.45216C2.27725 3.64826 2.79056 2.94369 3.46675 2.42088C4.14294 1.89808 4.95404 1.57866 5.80515 1.50001C5.30685 2.17414 5.06707 3.00473 5.12941 3.84071C5.19175 4.6767 5.55208 5.46254 6.14485 6.05531C6.73762 6.64808 7.52346 7.0084 8.35944 7.07074C9.19542 7.13308 10.026 6.8933 10.7001 6.39501Z" stroke="currentColor" fill="transparent" stroke-linecap="round" stroke-linejoin="round"></path></svg></span></button></div><a href="https://github.com/apify" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link icon" title="See our GitHub">GitHub</a><a href="https://discord.com/invite/jyEM2PRvMU" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link icon" title="Chat on Discord">Discord</a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a href="https://docs-v2.apify.com" target="_self" rel="noopener noreferrer" tabindex="-1" class="sidebarLogo_isFc"><img src="/img/apify_sdk.svg" alt="" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/apify_sdk_white.svg" alt="" class="themedImage_ToTc themedImage--dark_i4oU"><b>Apify Docs</b></a><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/platform">Home</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/platform/about">About</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/platform/tutorials">Tutorials</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorials&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/platform/tutorials/quick-start">Quick start</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/platform/tutorials/apify-scrapers">Apify scrapers</a><button aria-label="Toggle the collapsible sidebar category &#x27;Apify scrapers&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/platform/tutorials/building-public-actors">Building public actors</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/platform/tutorials/scraping-dynamic-content">Scraping dynamic content</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/platform/tutorials/log-into-a-website-using-puppeteer">Log into a website using Puppeteer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/platform/tutorials/log-in-by-transferring-cookies">Log in by transferring cookies</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/platform/tutorials/cache-data-to-improve-performance">Cache data to improve performance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/platform/tutorials/crawl-urls-from-a-google-sheet">Crawl URLs from a Google Sheet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/platform/tutorials/scrape-websites-using-the-sitemap">Scrape websites using the sitemap</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/platform/tutorials/analyze-pages-and-fix-errors">How to analyze pages and fix errors</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/platform/tutorials/scrape-paginated-sites">Scrape paginated sites</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/platform/tutorials/scrape-data-using-python">Scrape data using Python</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/platform/tutorials/process-data-using-python">Process scraped data with Python</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/platform/tutorials/use-apify-from-php">Use Apify from PHP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/platform/tutorials/integrations/run-actor-and-retrieve-data-via-api">Run actor and retrieve data via API</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/platform/web-scraping-101">Web scraping 101</a><button aria-label="Toggle the collapsible sidebar category &#x27;Web scraping 101&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/platform/robotic-process-automation">Robotic process automation</a><button aria-label="Toggle the collapsible sidebar category &#x27;Robotic process automation&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/platform/monitoring">Monitoring</a><button aria-label="Toggle the collapsible sidebar category &#x27;Monitoring&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/platform/actors">Actors</a><button aria-label="Toggle the collapsible sidebar category &#x27;Actors&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/platform/schedules">Schedules</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/platform/proxy">Proxy</a><button aria-label="Toggle the collapsible sidebar category &#x27;Proxy&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/platform/tutorials/integrations">Integrations</a><button aria-label="Toggle the collapsible sidebar category &#x27;Integrations&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/platform/access-rights">Access rights</a><button aria-label="Toggle the collapsible sidebar category &#x27;Access rights&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/platform/api-reference">API reference</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/platform/apify-sdk">Apify SDK</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/platform/tutorials"><span itemprop="name">Tutorials</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Scrape paginated sites</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>How to scrape websites with limited pagination</h1><p>Limited pagination is a common practice on e-commerce sites and is becoming more popular over time. It makes sense: a real user will never want to look through more than 200 pages of results – only bots love unlimited pagination. Fortunately, there are ways to overcome this limit while keeping our code clean and generic.</p><p><img loading="lazy" alt="Pagination in on Google search results page" src="data:image/webp;base64,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" width="532" height="187" class="img_ev3q"></p><blockquote><p>In a rush? Skip the tutorial and get the <a href="https://github.com/metalwarrior665/apify-utils/tree/master/examples/crawler-with-filters" target="_blank" rel="noopener">full code example</a>.</p></blockquote><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="-how-to-overcome-the-limit"><a href="#how-to-overcome-the-limit"></a> How to overcome the limit<a class="hash-link" href="#-how-to-overcome-the-limit" title="Direct link to heading">​</a></h2><p>Websites usually limit the pagination of a single (sub)category to somewhere between 1,000 to 20,000 listings. The site might have over a million listings in total. Without a proven algorithm, it will be very manual and almost impossible to scrape all listings.</p><p>We will first look at a couple ideas that don&#x27;t work so well and then present the <a href="#using-filter-ranges">final robust solution</a>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="-going-deeper-into-subcategories"><a href="#going-deeper-into-subcategories"></a> Going deeper into subcategories<a class="hash-link" href="#-going-deeper-into-subcategories" title="Direct link to heading">​</a></h3><p>This is usually the first solution that comes to mind. You traverse the smallest subcategories and hope that those are below the pagination limits. Unfortunately, there are two big problems with this approach:</p><ol><li>Any subcategory might be bigger than the pagination limit.</li><li>Some listings from the parent category might not be present in any subcategory.</li></ol><p>While you can often manually test if the second problem is true on the site, the first problem is a hard blocker. You might be just lucky, and it may work on this site but usually, traversing subcategories is just not enough. It can be used as a first step of the solution but not as the solution itself.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="-using-filters"><a href="#using-filters"></a> Using filters<a class="hash-link" href="#-using-filters" title="Direct link to heading">​</a></h3><p>Most websites also provide a way for the user to select search filters. These allow a more granular level of search than categories and can be combined with them. Common filters allow you to select a <strong>color</strong>, <strong>size</strong>, <strong>location</strong> and similar attributes.</p><p>At first, it might seem as an easy solution. Enqueue all possible filter combinations and that should be so granular that it will never hit a pagination limit. Unfortunately, this solution is still far from good.</p><ol><li>There is no guarantee that some products don&#x27;t slip through the chosen filter combinations.</li><li>The resulting split might be too granular and end up having too many tiny paginations with many duplicate products. This leads to scraping a lot more pages than necessary and makes analytics much harder.</li></ol><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="-using-filter-ranges"><a href="#using-filter-ranges"></a> Using filter ranges<a class="hash-link" href="#-using-filter-ranges" title="Direct link to heading">​</a></h3><p>The best option is to use only a specific type of filter that can be used as a range. The most common one is <strong>price range</strong> but there may be others like the apartment size, etc. You can split the pagination pages to only contain listings within that range, e.g. products costing between $10 and $20.</p><p>This has several benefits:</p><ol><li>All listings can eventually be found in a range.</li><li>The ranges do not overlap, so we scrape the smallest possible number of pages and avoid duplicate listings.</li><li>Ranges can be controlled by a generic algorithm that is simple to re-use for different sites.</li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="-splitting-pages-with-range-filters"><a href="#splitting-pages-with-range-filters"></a> Splitting pages with range filters<a class="hash-link" href="#-splitting-pages-with-range-filters" title="Direct link to heading">​</a></h2><p>In the previous section, we analyzed different options to split the pages to overcome the pagination limit. We have chosen range filters as the most reliable way to do that. In this section, we will discuss a generic algorithm to work with ranges, look at a few special cases and then write an example crawler.</p><p><img loading="lazy" alt="An example of range filters on a website" src="data:image/webp;base64,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" width="800" height="269" class="img_ev3q"></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="-the-algorithm"><a href="#the-algorithm"></a> The algorithm<a class="hash-link" href="#-the-algorithm" title="Direct link to heading">​</a></h3><p>The core algorithm is simple and can be used on any (even overlapping) range. This is a simplified presentation, we will discuss the details later.</p><ol><li>We choose a few pivot ranges with a similar number of products and enqueue them. For example, <strong>$0-$10</strong>, <strong>$100-$1000</strong>, <strong>$1000-$10000</strong>, <strong>$10000-</strong>.</li><li>For each range, we open the page and check if the listings are below the limit. If yes, we continue to step 3. If not, we split the filter in half, e.g. <strong>$0-$10</strong> to <strong>$0-$5</strong> and <strong>$5-$10</strong> and enqueue those again. We recursively repeat step <strong>2</strong> for each range as long as needed.</li><li>We now have a pagination URL that is below the limit, we enqueue it under a pagination label and start enqueuing products.</li></ol><p>Because the algorithm is recursive, we don&#x27;t need to think about how big the final ranges should be, the algorithm will find them over time.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="-special-cases-to-look-for"><a href="#special-cases-to-look-for"></a> Special cases to look for<a class="hash-link" href="#-special-cases-to-look-for" title="Direct link to heading">​</a></h3><p>We have the base algorithm, but before we start coding, let&#x27;s answer a few questions to get more insight.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="-can-the-ranges-overlap"><a href="#can-the-ranges-overlap"></a> Can the ranges overlap?<a class="hash-link" href="#-can-the-ranges-overlap" title="Direct link to heading">​</a></h4><p>Some sites will allow you to construct non-overlapping ranges. For example, you can set the ranges with cents, e.g. <strong>$0-$4.99</strong>, <strong>$5-$9.99</strong>, etc. If that is possible, create the pivot ranges this way, too.</p><p>Non-overlapping ranges should remove the possibility of duplicate products (unless a <a href="#can-a-listing-have-more-values">listing has multiple values</a>) and the lowest number of pages.</p><p>If the website supports only overlapping ranges (e.g. <strong>$0-$5</strong>, <strong>$5-10</strong>), it is not a big problem. Only a small portion of the listings will be duplicates, and they can be removed using a <a href="/platform/storage/request_queue.md">request queue</a>.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="-can-a-listing-have-more-values"><a href="#can-a-listing-have-more-values"></a> Can a listing have more values?<a class="hash-link" href="#-can-a-listing-have-more-values" title="Direct link to heading">​</a></h4><p>In rare cases, a listing can have more than one value that you are filtering in a range. A typical example is <a href="https://amazon.com" target="_blank" rel="noopener">amazon.com</a>, where each product has several offers and those offers have different prices. If any of those offers is within the range, the product is shown.</p><p>There is no easy way to get around this but the price range split works even with duplicate listings, just use a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set" target="_blank" rel="noopener">JS set</a> or request queue to deduplicate them.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="-how-is-the-range-passed-to-the-url"><a href="#how-is-the-range-passed-to-the-url"></a> How is the range passed to the URL?<a class="hash-link" href="#-how-is-the-range-passed-to-the-url" title="Direct link to heading">​</a></h4><p>In the easiest case, you can pass the range directly in the page&#x27;s URL. For example, <code>&lt;https://mysite.com/products?price=0-10&gt;</code>. Sometimes, you will need to do some query composition because the price range might be encoded together with more information into a single parameter.</p><p>Some sites don&#x27;t have page URLs with filters and instead load the filtered products via <a href="https://docs.apify.com/web-scraping-101/web-scraping-techniques#xhrs" target="_blank" rel="noopener">XHRs</a>. Those can be GET or POST requests with various <strong>URL</strong> and <strong>payload</strong> syntax.</p><p>The nice thing here is that if you get to understand how their internal API works, you can have it return more products per page or extract full product details just from this single request.</p><p>In addition, XHRs are smaller and faster than loading an HTML page. On the other hand, you should not overly abuse them (with setting overly large limits), as this can expose you.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="-does-the-website-show-the-number-of-products-for-each-filtered-page"><a href="#does-the-website-show-the-number-of-products-for-each-filtered-page"></a> Does the website show the number of products for each filtered page?<a class="hash-link" href="#-does-the-website-show-the-number-of-products-for-each-filtered-page" title="Direct link to heading">​</a></h4><p>If it does, it is a nice bonus. It gives us an easy way to check if we are over or below the pagination limit and helps with analytics.</p><p>If it doesn&#x27;t, we have to find a different way to check if the number of listings is within a limit. One option is to go to the last allowed page of the pagination. If that page is still full products, we can assume the filter is over the limit.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="-how-to-handle-open-ends-of-the-range"><a href="#how-to-handle-open-ends-of-the-range"></a> How to handle (open) ends of the range<a class="hash-link" href="#-how-to-handle-open-ends-of-the-range" title="Direct link to heading">​</a></h4><p>Logically, every full (price) range starts at 0 and ends at infinity. But the way this is encoded will differ on each site. The end of the price range can be either closed (0) or open (infinity). Open ranges require special handling when you split them (we will get to that).</p><p>Most sites will let you start with 0 (there might be exceptions, where you will have make the start open), so we can use just that. The high end is more complicated. Because you don&#x27;t know the biggest price, it is best to leave it open and handle it specially. Internally you can just assign <code>null</code> to the value.</p><p>Here are few examples of a query parameter with an open and closed high-end range:</p><ul><li>Open: <code>p:100-</code> (higher than 100), Closed: <code>p:100-200</code> (between 100 and 200)</li><li>Open: <code>min_price=100</code>, Closed: <code>min_price=100&amp;max_price=200</code></li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="-can-the-range-exceed-the-limit-on-a-single-value"><a href="#can-the-range-exceed-the-limit-on-a-single-value"></a> Can the range exceed the limit on a single value?<a class="hash-link" href="#-can-the-range-exceed-the-limit-on-a-single-value" title="Direct link to heading">​</a></h4><p>In very rare cases, a site will have so many listings that a single value (e.g. <strong>$100</strong> or <strong>$4.99</strong>) will include a number of listings over the limit. <a href="#the-algorithm">The basic algorithm</a> will recurse until the <strong>min</strong> value equals the <strong>max</strong> value and then stop because it cannot split that single value anymore.</p><p>In this rare case, you will need to add another range or other filters to combine it to get an even deeper split.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="-implementing-a-range-filter"><a href="#implementing-a-range-filter"></a> Implementing a range filter<a class="hash-link" href="#-implementing-a-range-filter" title="Direct link to heading">​</a></h3><p>This section shows a simple code example implementing our solution for an imaginary website. Writing a real solution will bring up more complex problems but the previous section should prepare you for some of them.</p><p>First, let&#x27;s define our imaginary site:</p><ul><li>It has a single <code>/products</code> path that contains all the products that we want to scrape.</li><li><strong>Max</strong> pagination limit is <strong>1000</strong>.</li><li>The site contains over a million products.</li><li>It allows for filtering over a price range with query parameters <code>min_price</code> and <code>max_price</code>.</li><li>If <code>min_price</code> or <code>max_price</code> are not defined, it opens that end of the range (all products up to or all products over that).</li><li>The site allows to specify the price in cents.</li><li>Pagination is done via <code>page</code> query parameter.</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="-define-and-enqueue-pivot-ranges"><a href="#define-and-enqueue-pivot-ranges"></a> Define and enqueue pivot ranges<a class="hash-link" href="#-define-and-enqueue-pivot-ranges" title="Direct link to heading">​</a></h4><p>This step is not necessary but it is useful. The algorithm doesn&#x27;t start with splitting over too large or too small values.</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">Actor</span><span class="token imports"> </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;apify&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">CheerioCrawler</span><span class="token imports"> </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;crawlee&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> </span><span class="token maybe-class-name">Actor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">init</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">MAX_PRODUCTS_PAGINATION</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// These is just an example, choose what makes sense for your site</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">PIVOT_PRICE_RANGES</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">min</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">max</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9.99</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">min</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">max</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">99.99</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">min</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">max</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">999.99</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">min</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">max</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9999.99</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">min</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">max</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// open-ended</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Let&#x27;s create a helper function for creating the filter URLs, you can move those to a utils.js file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">createFilterUrl</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">{</span><span class="token parameter"> min</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> max </span><span class="token parameter punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> minString </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">min_price=</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">min</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// We don&#x27;t want to pass the parameter at all if it is null (open-ended)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> maxString </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> max </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">&amp;max_price=</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">max</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">https://www.mysite.com/products?</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">minString</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">maxString</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// And another helper for getting filters back from the URL, we could also pass them in userData</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">getFiltersFromUrl</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">url</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> min </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token known-class-name class-name">Number</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">match</span><span class="token punctuation" style="color:#393A34">(</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex" style="color:#36acaa">min_price=([0-9.]+)</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Max price might be empty</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> maxMatch </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> url</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">match</span><span class="token punctuation" style="color:#393A34">(</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex" style="color:#36acaa">max_price=([0-9.]+)</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> max </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> maxMatch </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><span class="token known-class-name class-name">Number</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">maxMatch</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> min</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> max </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Actor setup things here</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> crawler </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">CheerioCrawler</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">requestHandler</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">context</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Let&#x27;s create the pivot requests</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> initialRequests </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> min</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> max </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">of</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">PIVOT_PRICE_RANGES</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    initialRequests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">url</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createFilterUrl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> min</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> max </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">label</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;FILTER&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Let&#x27;s start the crawl</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> crawler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">initialRequests</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> </span><span class="token maybe-class-name">Actor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="-define-the-logic-for-the-filter-page"><a href="#define-the-logic-for-the-filter-page"></a> Define the logic for the <code>FILTER</code> page<a class="hash-link" href="#-define-the-logic-for-the-filter-page" title="Direct link to heading">​</a></h4><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">CheerioCrawler</span><span class="token imports"> </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;crawlee&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Doesn&#x27;t matter what Crawler class we choose</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> crawler </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">CheerioCrawler</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Crawler options here</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">requestHandler</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">{</span><span class="token parameter"> request</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> $ </span><span class="token parameter punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> label </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> request</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">label </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;FILTER&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// Of course, change the selectors and make it more robust</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> numberOfProducts </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token known-class-name class-name">Number</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">$</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;.product-count&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">text</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// The filter is either good enough of we have to split it</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">numberOfProducts </span><span class="token operator" style="color:#393A34">&lt;=</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">MAX_PRODUCTS_PAGINATION</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token comment" style="color:#999988;font-style:italic">// We just pass the URL for scraping, we could optimize it so the page is not opened again</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> crawler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addRequests</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token literal-property property" style="color:#36acaa">url</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">request</span><span class="token template-string interpolation punctuation" style="color:#393A34">.</span><span class="token template-string interpolation property-access">url</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c">&amp;page=1</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token literal-property property" style="color:#36acaa">userData</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">label</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;PAGINATION&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token comment" style="color:#999988;font-style:italic">// Here we have to split the filter</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token comment" style="color:#999988;font-style:italic">// To be continued...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">label </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;PAGINATION&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// We know we are under the limit here</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// Enqueue next page as long as possible</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// Enqueue or scrape products normally</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="-split-price-filters"><a href="#split-price-filters"></a> Split price filters<a class="hash-link" href="#-split-price-filters" title="Direct link to heading">​</a></h4><p>We have the base of the crawler set up. The last part we are missing is the price filter splitting. Let&#x27;s use a generic function for this. We can place it into the <code>utils.js</code> file.</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// utils.js</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">splitFilter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">filter</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> min</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> max </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> filter</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Don&#x27;t forget that max can be null and we have to handle that situation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">max </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> min </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> max</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">throw</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">WRONG FILTER - min(</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">min</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c">) is greater than max(</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">max</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c">)</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// We crate a middle value for the split. If max in null, we will use double min as the middle value</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> middle </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> max</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> min </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token known-class-name class-name">Math</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">floor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">max </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> min</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> min </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// We have to do the Math.max and Math.min to prevent having min &gt; max</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> filterMin </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        min</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">max</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">Math</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">max</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">middle</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> min</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> filterMax </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">min</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> max </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><span class="token known-class-name class-name">Math</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">min</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">middle </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> max</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> middle </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        max</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// We return 2 new filters</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">filterMin</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> filterMax</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="-enqueue-the-filters"><a href="#enqueue-the-filters"></a> Enqueue the filters<a class="hash-link" href="#-enqueue-the-filters" title="Direct link to heading">​</a></h4><p>Let&#x27;s finish the crawler now. This code example will go inside the <code>else</code> block of the previous crawler example.</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> min</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> max </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getFiltersFromUrl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">url</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Our generic splitFilter function doesn&#x27;t account for decimal values so we will have to convert to cents and back to dollars</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> newFilters </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">splitFilter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">min</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> min </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">max</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> max </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// And we just enqueue those 2 new filters so the process will recursively repeat until all pages get to the PAGINATION phase</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> requestsToEnqueue </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> filter </span><span class="token keyword" style="color:#00009f">of</span><span class="token plain"> newFilters</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    requestsToEnqueue</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Remember that we have to convert back from cents to dollars</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">url</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createFilterUrl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">min</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> filter</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">min</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">max</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> filter</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">max</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">label</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;FILTER&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> crawler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addRequests</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">requestsToEnqueue</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="-summary"><a href="#summary"></a> Summary<a class="hash-link" href="#-summary" title="Direct link to heading">​</a></h2><p>And that&#x27;s it. We have an elegant and simple solution for a complicated problem. In a real project, you would want to make this a bit more robust, <a href="/platform/tutorials/analyze-pages-and-fix-errors">use logs</a>, and save analytics data. This will let you know what filters you went through and how many products each of them had.</p><p>Check out the <a href="https://github.com/metalwarrior665/apify-utils/tree/master/examples/crawler-with-filters" target="_blank" rel="noopener">full code example</a>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-12-20T11:43:17.000Z">Dec 20, 2022</time></b> by <b>Jindřich Bär</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/platform/tutorials/analyze-pages-and-fix-errors"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">How to analyze pages and fix errors</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/platform/tutorials/scrape-data-using-python"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Scrape data using Python</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#-how-to-overcome-the-limit" class="table-of-contents__link toc-highlight"> How to overcome the limit</a><ul><li><a href="#-going-deeper-into-subcategories" class="table-of-contents__link toc-highlight"> Going deeper into subcategories</a></li><li><a href="#-using-filters" class="table-of-contents__link toc-highlight"> Using filters</a></li><li><a href="#-using-filter-ranges" class="table-of-contents__link toc-highlight"> Using filter ranges</a></li></ul></li><li><a href="#-splitting-pages-with-range-filters" class="table-of-contents__link toc-highlight"> Splitting pages with range filters</a><ul><li><a href="#-the-algorithm" class="table-of-contents__link toc-highlight"> The algorithm</a></li><li><a href="#-special-cases-to-look-for" class="table-of-contents__link toc-highlight"> Special cases to look for</a></li><li><a href="#-implementing-a-range-filter" class="table-of-contents__link toc-highlight"> Implementing a range filter</a></li></ul></li><li><a href="#-summary" class="table-of-contents__link toc-highlight"> Summary</a></li></ul></div></div></div></div></main></div></div><footer class="footer_TWM6 light"><div class="container padding-horiz--lg"><div class="row"><div class="col col--5"><div class="row"><div class="col col--6"><div class="footerTitle_Te0m">Docs</div><ul class="clean-list"><li class="footer__item"><a class="footer__link-item" href="/academy">Academy</a></li><li class="footer__item"><a class="footer__link-item" href="/platform">Platform</a></li></ul></div><div class="col col--6"><div class="footerTitle_Te0m">Community</div><ul class="clean-list"><li class="footer__item"><a href="https://discord.com/invite/jyEM2PRvMU" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/apify" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/apify" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div></div><div class="col col--7"><div class="row"><div class="col col--3 col--offset-9"><div class="footerTitle_Te0m">More</div><ul class="clean-list"><li class="footer__item"><a href="https://apify.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Apify Platform<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://crawlee.dev" target="_blank" rel="noopener noreferrer" class="footer__link-item">Crawlee<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://docusaurus.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Docusaurus<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/apify" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div></div></div><div class="row padding-vert--md padding-top--lg"><div class="col padding-vert--md col--6"><div class="freeAndOpenSource_uEGS"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="alignMiddle_tjkH"><path d="m23.85 21.426-1.78-2.91a.48.48 0 0 1-.07-.26v-4.13c0-1.78-1.71-3.07-3.52-4.45a.511.511 0 0 1-.2-.36.53.53 0 0 1 .14-.4 4.93 4.93 0 0 0 1.07-5.88 5.08 5.08 0 0 0-8.08-1.29l-1.06 1a.48.48 0 0 1-.67 0l-1.06-1a5.09 5.09 0 0 0-8.09 1.29 5 5 0 0 0 1 5.76l7.76 8a1.059 1.059 0 0 0 .77.32 1.08 1.08 0 0 0 .78-.32.64.64 0 0 0 .14-.66 3.79 3.79 0 0 1-.2-1.38 3.749 3.749 0 0 1 4.92-3.37.49.49 0 0 0 .51-.13l.15-.15a.5.5 0 0 1 .66-.05l.3.23c1.22.92 2.73 2.07 2.73 2.85v4.55a1 1 0 0 0 .15.53l2 3.26a1 1 0 1 0 1.7-1l-.05-.05Z" fill="#B3B8D2"></path><path d="M16.09 13.196a2.37 2.37 0 0 0-3.19 0 2.38 2.38 0 0 0-.18 3.39l1.63 1.77a.55.55 0 0 1 .13.34v1c0 1.3 1.52 2.59 2 2.95a.91.91 0 0 0 .54.19.88.88 0 0 0 .54-1.57 3.889 3.889 0 0 1-1.31-1.57v-1.57a.86.86 0 0 0-.23-.59l-2-2.18a.58.58 0 0 1-.17-.45.66.66 0 0 1 .21-.44.64.64 0 0 1 .85 0l2 1.86a.874.874 0 1 0 1.19-1.28l-2.01-1.85Z" fill="#B3B8D2"></path></svg><span class="alignMiddle_tjkH">Apify SDK is free and open source</span></div></div><div class="col padding-vert--md col--6 text--right"><span class="builtBy_ZXqe"><span class="alignMiddle_tjkH">Built by</span><svg width="91" height="25" fill="none" xmlns="http://www.w3.org/2000/svg" class="alignMiddle_tjkH"><path d="M3.135 2.85A3.409 3.409 0 0 0 .227 6.699l2.016 14.398 8.483-19.304-7.59 1.059Z" fill="#97D700"></path><path d="M23.604 14.847 22.811 3.78a3.414 3.414 0 0 0-3.64-3.154c-.077 0-.153.014-.228.025l-3.274.452 7.192 16.124a3.4 3.4 0 0 0 .743-2.379Z" fill="#71C5E8"></path><path d="M5.336 24.595a3.39 3.39 0 0 0 1.706-.248l12.35-5.211L13.514 5.97 5.336 24.595Z" fill="#FF9013"></path><path d="M33.83 5.304h3.903l5.448 14.623h-3.494l-1.022-2.994h-5.877l-1.025 2.994h-3.384L33.83 5.304Zm-.177 9.032h4.14l-2-5.994h-.086l-2.054 5.994Zm25.189-9.032h3.302v14.623h-3.302V5.304Zm5.792 0h10.71v2.7h-7.4v4.101h5.962v2.632h-5.963v5.186h-3.309V5.303Zm17.482 9.076-5.498-9.076h3.748l3.428 6.016h.085l3.599-6.016H91l-5.56 9.054v5.569h-3.324v-5.548ZM51.75 5.304h-7.292v14.623h3.3v-4.634h3.993a4.995 4.995 0 1 0 0-9.99Zm-.364 7.417h-3.628V7.875h3.627a2.423 2.423 0 0 1 0 4.846Z" fill="#fff"></path></svg></span></div></div></div></footer></div>
<script src="/assets/js/runtime~main.54bcee31.js"></script>
<script src="/assets/js/main.8492f025.js"></script>
</body>
</html>