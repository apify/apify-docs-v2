<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-academy docs-doc-id-tutorials/python/scrape_data_python">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.0">
<title data-rh="true">How to scrape and process data using Python | Apify Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://apify.com/img/og/docs.png"><meta data-rh="true" name="twitter:image" content="https://apify.com/img/og/docs.png"><meta data-rh="true" property="og:url" content="https://docs.apify.com/academy/python/scrape-data-python"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="robots" content="noindex, nofollow"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-academy-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-academy-current"><meta data-rh="true" property="og:title" content="How to scrape and process data using Python | Apify Documentation"><meta data-rh="true" name="description" content="Learn how to create a Python actor and use Python libraries to scrape, process and visualize data extracted from the web."><meta data-rh="true" property="og:description" content="Learn how to create a Python actor and use Python libraries to scrape, process and visualize data extracted from the web."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.apify.com/academy/python/scrape-data-python"><link data-rh="true" rel="alternate" href="https://docs.apify.com/academy/python/scrape-data-python" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.apify.com/academy/python/scrape-data-python" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://N8EOCSBQGH-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Apify Documentation" href="/opensearch.xml">



<script src="/js/custom.js"></script><link rel="stylesheet" href="/assets/css/styles.491824f1.css">
<link rel="preload" href="/assets/js/runtime~main.59ce9323.js" as="script">
<link rel="preload" href="/assets/js/main.6eff774b.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div style="--ifm-navbar-height:68px;margin:0;padding:0;box-sizing:border-box"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div style="width:100%;height:fit-content;align-items:center;display:flex;flex-direction:column"><div class="navbar__inner"><div class="navbar__container"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://docs.apify.com" target="_self" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/apify_sdk.svg" alt="" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/apify_sdk_white.svg" alt="" class="themedImage_ToTc themedImage--dark_i4oU"></div></a><a href="https://docs.apify.com/academy" target="_self" rel="dofollow" class="navbar__item navbar__link navbar__link--active">Academy</a><a href="https://docs.apify.com/platform" target="_self" rel="dofollow" class="navbar__item navbar__link">Platform</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__item navbar__link">API</a><ul class="dropdown__menu"><li><a href="https://docs.apify.com/api/v2/" target="_self" rel="dofollow" class="dropdown__link">Reference</a></li><li><a href="https://docs.apify.com/api/client/js/" target="_self" rel="dofollow" class="dropdown__link">Client for JavaScript</a></li><li><a href="https://docs.apify.com/api/client/python/" target="_self" rel="dofollow" class="dropdown__link">Client for Python</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__item navbar__link">SDK</a><ul class="dropdown__menu"><li><a href="https://docs.apify.com/sdk/js/" target="_self" rel="dofollow" class="dropdown__link">SDK for JavaScript</a></li><li><a href="https://docs.apify.com/sdk/python/" target="_self" rel="dofollow" class="dropdown__link">SDK for Python <span class="beta-chip">beta</span></a></li></ul></div><a href="https://docs.apify.com/cli/" target="_self" rel="dofollow" class="navbar__item navbar__link">CLI</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link navbar__item">Open Source</a><ul class="dropdown__menu"><li><a href="https://crawlee.dev" target="_blank" rel="dofollow" class="dropdown__link">Crawlee<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://github.com/apify/got-scraping" target="_blank" rel="noopener noreferrer" class="dropdown__link">Got Scraping<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://github.com/apify/fingerprint-suite" target="_blank" rel="noopener noreferrer" class="dropdown__link">Fingerprint Suite<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://github.com/apify" target="_blank" rel="noopener noreferrer" class="dropdown__link">See our GitHub<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="toggle_HIU5 colorModeToggle_nCl2"><button class="clean-btn toggleButton_ezTW toggleButtonDisabled_E3zm" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><span><svg viewBox="0 0 13 12" fill="none" xmlns="http://www.w3.org/2000/svg" width="14" height="14" class="lightToggleIcon_kM7M"><g clip-path="url(#clip0_833_8168)"><path d="M6.59998 8.49999C7.98069 8.49999 9.09998 7.3807 9.09998 5.99999C9.09998 4.61928 7.98069 3.49999 6.59998 3.49999C5.21926 3.49999 4.09998 4.61928 4.09998 5.99999C4.09998 7.3807 5.21926 8.49999 6.59998 8.49999Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M6.59985 0.5V1.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M6.59985 10.5V11.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M2.7099 2.11L3.4199 2.82" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M9.77991 9.17999L10.4899 9.88999" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M1.09998 6H2.09998" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M11.0999 6H12.0999" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M2.7099 9.88999L3.4199 9.17999" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M9.77991 2.82L10.4899 2.11" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></g><defs><clipPath id="clip0_833_8168"><rect width="12" height="12" fill="white" transform="translate(0.599976)"></rect></clipPath></defs></svg><svg viewBox="0 0 13 12" width="14" height="14" class="darkToggleIcon_BL0U"><path d="M10.7001 6.39501C10.6215 7.24611 10.3021 8.05721 9.77927 8.7334C9.25646 9.40959 8.55189 9.92291 7.748 10.2133C6.9441 10.5036 6.07414 10.5591 5.2399 10.3731C4.40565 10.187 3.64164 9.76728 3.03726 9.1629C2.43287 8.55851 2.01312 7.7945 1.8271 6.96026C1.64108 6.12602 1.6965 5.25605 1.98688 4.45216C2.27725 3.64826 2.79056 2.94369 3.46675 2.42088C4.14294 1.89808 4.95404 1.57866 5.80515 1.50001C5.30685 2.17414 5.06707 3.00473 5.12941 3.84071C5.19175 4.6767 5.55208 5.46254 6.14485 6.05531C6.73762 6.64808 7.52346 7.0084 8.35944 7.07074C9.19542 7.13308 10.026 6.8933 10.7001 6.39501Z" stroke="currentColor" fill="transparent" stroke-linecap="round" stroke-linejoin="round"></path></svg></span></button></div><a href="https://github.com/apify" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link icon" title="See our GitHub">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://discord.com/invite/jyEM2PRvMU" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link icon" title="Chat on Discord">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/academy">Home</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item section-header"><div class="menu__list-item-collapsible"><a class="menu__link">Web scraping &amp; Automation</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/academy/web-scraping-for-beginners">Web scraping for beginners</a><button aria-label="Toggle the collapsible sidebar category &#x27;Web scraping for beginners&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/academy/puppeteer-playwright">Puppeteer &amp; Playwright</a><button aria-label="Toggle the collapsible sidebar category &#x27;Puppeteer &amp; Playwright&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/academy/api-scraping">API scraping</a><button aria-label="Toggle the collapsible sidebar category &#x27;API scraping&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/academy/switching-to-typescript">Switching to TypeScript</a><button aria-label="Toggle the collapsible sidebar category &#x27;Switching to TypeScript&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/academy/advanced-web-scraping">Advanced web scraping</a><button aria-label="Toggle the collapsible sidebar category &#x27;Advanced web scraping&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item section-header"><div class="menu__list-item-collapsible"><a class="menu__link">Apify Platform</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/academy/apify-platform">Introduction to Apify Platform</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/academy/getting-started">Getting started</a><button aria-label="Toggle the collapsible sidebar category &#x27;Getting started&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/academy/deploying-your-code">Deploying your code</a><button aria-label="Toggle the collapsible sidebar category &#x27;Deploying your code&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/academy/get-most-of-actors">Getting the most of actors on Apify Store</a><button aria-label="Toggle the collapsible sidebar category &#x27;Getting the most of actors on Apify Store&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/academy/running-a-web-server">Running a web server on the Apify platform</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/academy/expert-scraping-with-apify">Expert scraping with Apify</a><button aria-label="Toggle the collapsible sidebar category &#x27;Expert scraping with Apify&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item section-header"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active">Tutorials</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/academy/tutorials">What&#x27;s this section?</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/academy/node-js">Node.js tutorials</a><button aria-label="Toggle the collapsible sidebar category &#x27;Node.js tutorials&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/academy/python">Python tutorials</a><button aria-label="Toggle the collapsible sidebar category &#x27;Python tutorials&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/academy/python/scrape-data-python">How to scrape and process data using Python</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item section-header"><div class="menu__list-item-collapsible"><a class="menu__link">Glossary</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/academy/glossary">Why a glossary?</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/academy/tools">Tools</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tools&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/academy/concepts">Concepts</a><button aria-label="Toggle the collapsible sidebar category &#x27;Concepts&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_z5aJ"><div class="docItemContainer_c0TR"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/academy"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_xK9p"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Tutorials</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/academy/python"><span itemprop="name">Python tutorials</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">How to scrape and process data using Python</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>How to scrape data in Python using Beautiful Soup</h1><p><strong>Learn how to create a Python actor and use Python libraries to scrape, process and visualize data extracted from the web.</strong></p><hr><p>Web scraping is not limited to the JavaScript world. The Python ecosystem contains some pretty powerful scraping tools as well. One of those is <a href="https://www.crummy.com/software/BeautifulSoup/" target="_blank" rel="noopener">Beautiful Soup</a>, a library for parsing HTML and easy navigation or modification of a DOM tree.</p><p>This tutorial shows you how to write a Python <a href="/academy/getting-started/actors">actor</a> for scraping the weather forecast from <a href="https://www.bbc.com/weather" target="_blank" rel="noopener">BBC Weather</a> and process the scraped data using <a href="https://pandas.pydata.org/" target="_blank" rel="noopener">Pandas</a>.</p><blockquote><p>In a rush? Skip this tutorial and get the <a href="https://github.com/apify/apify-docs/tree/master/examples/python-data-scraper/" target="_blank" rel="noopener">full code example</a>.</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="exploring-the-bbc-weather-page">Exploring the BBC Weather page<a href="#exploring-the-bbc-weather-page" class="hash-link" aria-label="Direct link to Exploring the BBC Weather page" title="Direct link to Exploring the BBC Weather page">​</a></h2><p>BBC Weather offers you the weather forecast for the upcoming 14 days for a large selection of places around the world. Let&#x27;s say we want to decide on our next holiday destination. We&#x27;re choosing between Prague, New York, and Honolulu, and we will pick the destination based on which one has the best weather. To do that, we will scrape the weather forecast for each of our options, and then compare the results.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="understanding-the-url-format">Understanding the URL format<a href="#understanding-the-url-format" class="hash-link" aria-label="Direct link to Understanding the URL format" title="Direct link to Understanding the URL format">​</a></h3><p>First, we need to look around the BBC Weather page and understand how the weather data is being retrieved and presented. If we open the <a href="https://www.bbc.com/weather" target="_blank" rel="noopener">BBC Weather</a> page and search for Prague, we can see that it opened a page with a URL ending in a seven-digit number, which we can assume is the ID of the displayed location BBC Weather uses internally. Opening a different location changes only that number in the URL, confirming our assumptions.</p><p>The page shows the weather forecast for the upcoming 14 days. If we hover over the days in the displayed carousel, we can see that the link for each day leads to a URL ending with <code>/day{X}</code>, with <code>{X}</code> representing how many days in the future the specific day is.</p><p>Combining this information gives us the full format for the URL of a page for a given location and day: <code>https://www.bbc.com/weather/{LOCATION_ID}/day{DAY_OFFSET}</code>.</p><p><img loading="lazy" alt="BBC Weather URL format" src="/assets/images/bbc-weather-url-format-b2acd8fbedf89c9854861db60be3f600.webp" width="2560" height="1958" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="determining-the-forecasts-starting-date">Determining the forecast&#x27;s starting date<a href="#determining-the-forecasts-starting-date" class="hash-link" aria-label="Direct link to Determining the forecast&#x27;s starting date" title="Direct link to Determining the forecast&#x27;s starting date">​</a></h3><p>Looking more closely at the BBC Weather page, we can see that it shows the forecast for each day from 6:00 AM to 5:00 AM the next day. But what happens when we view a location where the current time is between midnight and 5 AM? Trying that, we can see that, in the day represented by <strong>Tonight</strong>, there are only a few slots for the hours between midnight and 5 AM displayed. This means that the first displayed day can either represent the current date at the location, or the day before the current date. To find out which of these two it is, we will first have to determine the current date and time at the location, and then possibly adjust it by one day based on whether the date matches the first displayed day.</p><p><img loading="lazy" alt="BBC Weather displaying a location with current time between midnight and 5 AM" src="/assets/images/bbc-weather-after-midnight-0b1d2ec9172fcbf70e5036e4525362bc.webp" width="2560" height="1958" class="img_ev3q"></p><p>To determine the current date and time at the displayed location, we will need to know the location&#x27;s timezone. Fortunately, the timezone and its offset to GMT are displayed near the bottom of the page.</p><p><img loading="lazy" alt="The timezone offset on the BBC Weather page" src="data:image/webp;base64,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" width="954" height="176" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="understanding-the-element-structure">Understanding the element structure<a href="#understanding-the-element-structure" class="hash-link" aria-label="Direct link to Understanding the element structure" title="Direct link to Understanding the element structure">​</a></h3><p>To extract data from the page, we need to figure out where exactly in the internal page structure it is stored.</p><p>If we right-click on the day title in the top carousel (<strong>Today</strong> or <strong>Tonight</strong>) and select <strong>Inspect</strong> in the popup menu, we can open the Chrome DevTools Inspector with the clicked element highlighted. We can see that the element with the currently displayed day in the top carousel has the class <code>wr-day--active</code>, and that the element with the day&#x27;s title has the class <code>wr-day__title</code> and the accessibility label attribute <code>aria-label</code> contains the actual date of that day, not just <strong>Today</strong> or <strong>Tonight</strong>. Additionally, the timezone information is in an element with the class <code>wr-c-footer-timezone__item</code>. There are two elements with the same class, so we will need to pick the second one when parsing the page.</p><p>Exploring the document tree further, we can see that the element containing all the displayed hours has the class <code>wr-time-slot-container__slots</code>. The elements with the forecast for a given hour have the class <code>wr-time-slot</code>. In each time slot, the element containing the slot&#x27;s hour has the class <code>wr-time-slot-primary__hours</code> and the element containing the slot&#x27;s predicted temperature in degrees Celsius has the class <code>wr-value--temperature--c</code>.</p><p><img loading="lazy" alt="BBC Weather with the DevTools Inspector open" src="/assets/images/bbc-weather-devtools-9b9c8b6fe331163b9816449a04c8d1c2.webp" width="2560" height="1958" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="scraping-the-data-from-the-page">Scraping the data from the page<a href="#scraping-the-data-from-the-page" class="hash-link" aria-label="Direct link to Scraping the data from the page" title="Direct link to Scraping the data from the page">​</a></h2><p>Now that we understand the element structure of the page and know where to find all the data we need, we can start writing the scraper.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="setting-up-the-actor">Setting up the actor<a href="#setting-up-the-actor" class="hash-link" aria-label="Direct link to Setting up the actor" title="Direct link to Setting up the actor">​</a></h3><p>First, we need to create a new actor. To do this, go to <a href="https://console.apify.com/" target="_blank" rel="noopener">Apify Console</a>, open the <a href="https://console.apify.com/actors" target="_blank" rel="noopener">Actors section</a>, click on the <strong>Create new</strong> button in the top right, and select the <strong>Example: Hello world in Python</strong> actor template.</p><p>In the page that opens, you can see your newly created actor. In the <strong>Settings</strong> tab, you can give it a name (e.g. <code>bbc-weather-scraper</code>) and further customize its settings. We&#x27;ll skip customizing the settings for now, the defaults should be fine. In the <strong>Source</strong> tab, you can see the files that are at the heart of the actor. There are several of them, but only two are important for us now, <code>main.py</code> and <code>requirements.txt</code>.</p><p>First we&#x27;ll start with the <code>requirements.txt</code> file. Its purpose is to list all the third-party packages that your actor will use. We will be using the <code>requests</code> package for downloading the BBC Weather pages, and the <code>beautifulsoup4</code> package for parsing and processing the downloaded pages. We don&#x27;t particularly care about the specific versions of these packages, so we just list them in the file:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Add your dependencies here.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># See https://pip.pypa.io/en/latest/cli/pip_install/#requirements-file-format</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># for how to format them</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">beautifulsoup4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">requests</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="writing-the-code">Writing the code<a href="#writing-the-code" class="hash-link" aria-label="Direct link to Writing the code" title="Direct link to Writing the code">​</a></h3><p>Finally, we can get to writing the main logic for the actor, which will live in the <code>main.py</code> file. Let&#x27;s delete everything currently in it and start from an empty file.</p><p>First, we need to import all the packages we will use in the code:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> datetime </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> datetime</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> time</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> timedelta</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> timezone</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> os</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> re</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> apify_client </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> ApifyClient</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> bs4 </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> BeautifulSoup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Next, let&#x27;s set up the locations we want to scrape in a constant for easier reference and, optionally, modification.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Locations which to scrape and their BBC Weather IDs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LOCATIONS </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Prague&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;3067696&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Honolulu&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;5856195&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;New York&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;5128581&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="extracting-the-data">Extracting the data<a href="#extracting-the-data" class="hash-link" aria-label="Direct link to Extracting the data" title="Direct link to Extracting the data">​</a></h4><p>We&#x27;ll be scraping each location separately. For each location, we need to know in which timezone it resides and what is the first displayed date in the weather forecast for that location. We will scrape each of the 14 forecast days one by one. For each day, we will first download its forecast page using the <code>requests</code> library, and then parse the downloaded HTML using the <code>BeautifulSoup</code> parser:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># List with scraped results</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">weather_data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Scrape each location separately</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">location_name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> location_id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> LOCATIONS</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&#x27;Scraping weather from </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">location_name</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">...&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    location_timezone </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">None</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    first_displayed_date </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">None</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> day_offset </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">14</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Get the BBC Weather page for the given location and day and parse it with BeautifulSoup</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        response </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&#x27;https://www.bbc.com/weather/</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">location_id</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">/day</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">day_offset</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        soup </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> BeautifulSoup</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">content</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;html.parser&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When scraping a location, we need to know in which timezone it lies, and what date the first displayed day of the forecast represents. We can find that out at the beginning, when scraping the first day of the forecast for that location.</p><p>To get the necessary data, we will need to find the elements in which it is contained. Let&#x27;s use the <code>soup.find(...)</code> and <code>soup.findAll(...)</code> methods, which find elements matching some specified conditions in the parsed HTML.</p><p>First, we extract the timezone from the second element with class <code>wr-c-footer-timezone__item</code>. The timezone information is described there with a full sentence, but we&#x27;re only interested in the numerical representation of the timezone offset, so we parse it out using a regular expression. With the timezone offset parsed, we can construct a <code>timezone</code> object and from that get the current datetime at the location.</p><p>Afterwards, we can figure out which date is represented by the first displayed day. We find the element with the class <code>wr-day--active</code> containing the header for the currently displayed day. Inside it, we find the element with the title of that day, which has the class <code>wr-day__title</code>. This element has the accessibility label containing the actual date of the day in its <code>aria-label</code> attribute, but it contains only the day and month and not the year, so we can&#x27;t use it directly. Instead, to get the full date of the first displayed day, we compare the day from the accessibility label and the day from the current datetime at the location. If they match, we know the first displayed date is the current date at the location. If they don&#x27;t, we know the first displayed date is the day before the current date at the location.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># When parsing the first day, find out what day it represents,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># to know when do the results start</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> day_offset </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># Get the timezone offset written in the page footer and parse it</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            tz_description </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> soup</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">find_all</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">class_</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;wr-c-footer-timezone__item&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            tz_offset_match </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">search</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">r&#x27;([+-]\d\d)(\d\d)&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tz_description</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            tz_offset_hours </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tz_offset_match</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">group</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            tz_offset_minutes </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tz_offset_match</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">group</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># Get the current date and time at the scraped location</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            timezone_offset </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> timedelta</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">hours</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">tz_offset_hours</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> minutes</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">tz_offset_minutes</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            location_timezone </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> timezone</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">timezone_offset</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            location_current_datetime </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> datetime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">now</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tz</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">location_timezone</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># The times displayed for each day are from 6:00 AM that day to 5:00 AM the next day,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># so &quot;today&quot; on BBC Weather might actually mean &quot;yesterday&quot; in actual datetime.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># We have to parse the accessibility label containing the actual date on the header for the first day</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># and compare it with the current date at the location, then adjust the date accordingly</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            day_carousel_item </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> soup</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">find</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">class_</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;wr-day--active&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            day_carousel_title </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> day_carousel_item</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">find</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">class_</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;wr-day__title&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;aria-label&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            website_first_displayed_item_day </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">search</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">r&#x27;\d{1,2}&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> day_carousel_title</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">group</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> location_current_datetime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">day </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> website_first_displayed_item_day</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                first_displayed_date </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> location_current_datetime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">date</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                first_displayed_date </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> location_current_datetime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">date</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> timedelta</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">days</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now that we&#x27;ve figured out the date of the first displayed day, we can extract the predicted weather from each hour of each forecast day. The forecast for the displayed day is in the element with class <code>wr-time-slot-container__slots</code>, and that element contains time slots for each predicted hour represented by elements with the class <code>wr-time-slot</code>. In each time slot, the element with the class <code>wr-time-slot-primary__hours</code> contains the hour of the time slot. The element with the class <code>wr-value--temperature--c</code> contains the temperature in degrees Celsius.</p><p>To get the datetime of each slot, we need to combine the date of the first displayed day, the hour displayed in the slot, and the timezone of the currently processed location. Since the page shows the forecast for each day from 6 AM to 5 AM the next day, we need to add one day to the slots from midnight to 5 AM to get the correct datetime.</p><p>Finally, we can put all the extracted information together and push them to the array holding the resulting data.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Go through the elements for each displayed time slot of the displayed day</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        slot_container </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> soup</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">find</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">class_</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;wr-time-slot-container__slots&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> slot </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> slot_container</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">find_all</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">class_</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;wr-time-slot&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># Find out the date and time of the displayed element from the day offset and the displayed hour.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># The times displayed for each day are from 6:00 AM that day to 5:00 AM the next day,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># so anything between midnight and 6 AM actually represents the next day</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            slot_hour </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">slot</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">find</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">class_</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;wr-time-slot-primary__hours&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            slot_datetime </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> datetime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">combine</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">first_displayed_date</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> time</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">hour</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">slot_hour</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tzinfo</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">location_timezone</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            slot_datetime </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> timedelta</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">days</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">day_offset</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> slot_hour </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                slot_datetime </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> timedelta</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">days</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># Parse the temperature from the right element</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            slot_temperature </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">slot</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">find</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">class_</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;wr-value--temperature--c&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># Add the parsed data to the result list</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            weather_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">&#x27;datetime&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> slot_datetime</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">&#x27;location&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> location_name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">&#x27;temperature&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> slot_temperature</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="storing-the-data">Storing the data<a href="#storing-the-data" class="hash-link" aria-label="Direct link to Storing the data" title="Direct link to Storing the data">​</a></h4><p>As the last step, we need to store the scraped data in a dataset on the Apify platform, so that we can access it later. We do that through the <a href="https://docs-v2.apify.com/client-python" target="_blank" rel="noopener">Apify API Client for Python</a>, which greatly simplifies working with the Apify platform and allows you to use its functions without having to call the Apify API directly.</p><p>First, we initialize an <code>ApifyClient</code> instance. All the necessary arguments are automatically provided to the actor process as environment variables accessible in Python through the <code>os.environ</code> mapping. We will save the data into the default dataset belonging to the actor run, so we create a sub-client for working with that dataset, and push the data into it using its <code>.push_items(...)</code> method.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Initialize the main ApifyClient instance</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">client </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ApifyClient</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">environ</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;APIFY_TOKEN&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> api_url</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">environ</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;APIFY_API_BASE_URL&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Get the resource subclient for working with the default dataset of the actor run</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default_dataset_client </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> client</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dataset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">environ</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;APIFY_DEFAULT_DATASET_ID&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Finally, push all the results into the dataset</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default_dataset_client</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">push_items</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">weather_data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&#x27;Results have been saved to the dataset with ID </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">os</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">environ</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">[</span><span class="token string-interpolation interpolation string" style="color:#e3116c">&quot;APIFY_DEFAULT_DATASET_ID&quot;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">]</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="running-the-actor">Running the actor<a href="#running-the-actor" class="hash-link" aria-label="Direct link to Running the actor" title="Direct link to Running the actor">​</a></h3><p>And that&#x27;s it! Now you can save the changes in the editor, and then click <strong>Build and run</strong> at the bottom of the page. The actor will get built, the built actor image will get saved for future reuse, and then it will be executed. You can follow the progress of the actor build and the actor run in the <strong>Last build</strong> and <strong>Last run</strong> tabs, respectively, in the developer console in the actor source view. Once the actor finishes running, you can view the scraped data in the <strong>Dataset</strong> tab in the actor run view.</p><p><img loading="lazy" alt="Building and running the BBC Weather Scraper actor" src="/assets/images/bbc-weather-scraper-source-76fb9b17bd5e5c8a93e4554299a7aa80.webp" width="2560" height="1958" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-process-data-in-python-using-pandas">How to process data in Python using Pandas<a href="#how-to-process-data-in-python-using-pandas" class="hash-link" aria-label="Direct link to How to process data in Python using Pandas" title="Direct link to How to process data in Python using Pandas">​</a></h2><p>Earlier in this tutorial, we learned how to scrape data from the web in Python using the <a href="https://www.crummy.com/software/BeautifulSoup/" target="_blank" rel="noopener">Beautiful Soup</a> library. The Python ecosystem&#x27;s strengths lie mainly in data processing, though, so in this tutorial we will learn how to process the data stored in an Apify dataset using the <a href="https://pandas.pydata.org/" target="_blank" rel="noopener">Pandas</a> library, and how to visualize it using <a href="https://matplotlib.org/" target="_blank" rel="noopener">Matplotlib</a>.</p><blockquote><p>In a rush? Skip this tutorial and <a href="https://github.com/apify/apify-docs/tree/master/examples/python-data-parser/" target="_blank" rel="noopener">get the full code example</a>.</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="processing-previously-scraped-data">Processing previously scraped data<a href="#processing-previously-scraped-data" class="hash-link" aria-label="Direct link to Processing previously scraped data" title="Direct link to Processing previously scraped data">​</a></h2><p>In the previous tutorial, we set out to select our next holiday destination based on the forecast of the upcoming weather there. We have written an actor that scrapes the BBC Weather forecast for the upcoming two weeks for three destinations: Prague, New York, and Honolulu. It then saves the scraped data to a <a href="/platform/storage/dataset">dataset</a> on the Apify platform.</p><p>Now, we need to process the scraped data and make a simple visualization that will help us decide which location has the best weather, and will therefore become our next holiday destination.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="setting-up-the-actor">Setting up the actor<a href="#setting-up-the-actor" class="hash-link" aria-label="Direct link to Setting up the actor" title="Direct link to Setting up the actor">​</a></h3><p>First, we need to create another actor. You can do it the same way as before - go to the <a href="https://console.apify.com/" target="_blank" rel="noopener">Apify Console</a>, open the <a href="https://console.apify.com/actors" target="_blank" rel="noopener">Actors section</a>, click on the <strong>Create new</strong> button in the top right, and select the <strong>Example: Hello world in Python</strong> actor template.</p><p>In the page that opens, you can see your newly created actor. In the <strong>Settings</strong> tab, you can give it a name (e.g. <code>bbc-weather-parser</code>) and further customize its settings. We&#x27;ll skip customizing the settings for now, the defaults should be fine. In the <strong>Source</strong> tab, you can see the files that are at the heart of the actor. There are several of them, but only two are important for us now, <code>main.py</code> and <code>requirements.txt</code>.</p><p>First, we&#x27;ll start with the <code>requirements.txt</code> file. Its purpose is to list all the third-party packages that your actor will use. We will be using the <code>pandas</code> package for parsing the downloaded weather data, and the <code>matplotlib</code> package for visualizing it. We don&#x27;t particularly care about the specific versions of these packages, so we just list them in the file:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Add your dependencies here.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># See https://pip.pypa.io/en/latest/cli/pip_install/#requirements-file-format</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># for how to format them</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">matplotlib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pandas</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The actor&#x27;s main logic will live in the <code>main.py</code> file. Let&#x27;s delete everything currently in it and start from an empty file.</p><p>Next, we&#x27;ll import all the packages we will use in the code:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> io </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> BytesIO</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> os</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> apify_client </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> ApifyClient</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> apify_client</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">consts </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> ActorJobStatus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> pandas</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="scraping-the-data">Scraping the data<a href="#scraping-the-data" class="hash-link" aria-label="Direct link to Scraping the data" title="Direct link to Scraping the data">​</a></h3><p>Next, we need to run the weather scraping actor and access its results. We do that through the <a href="https://docs-v2.apify.com/client-python" target="_blank" rel="noopener">Apify API Client for Python</a>, which greatly simplifies working with the Apify platform and allows you to use its functions without having to call the Apify API directly.</p><p>First, we initialize an <code>ApifyClient</code> instance. All the necessary arguments are automatically provided to the actor process as environment variables accessible in Python through the <code>os.environ</code> mapping. We need to run the actor from the previous tutorial, which we have named <code>bbc-weather-scraper</code>, and wait for it to finish. So, we create a sub-client for working with that actor and run the actor through it. We then check whether the actor run has succeeded. If so, we create a client for working with its default dataset.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Initialize the main ApifyClient instance</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">client </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ApifyClient</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">environ</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;APIFY_TOKEN&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> api_url</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">environ</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;APIFY_API_BASE_URL&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Run the weather scraper and wait for it to finish</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Downloading the weather data...&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scraper_run </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> client</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">actor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;~bbc-weather-scraper&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Check if the scraper finished successfully, otherwise raise an error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> scraper_run</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;status&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> ActorJobStatus</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SUCCEEDED</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">raise</span><span class="token plain"> RuntimeError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;The weather scraper run has failed&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Get the resource sub-client for working with the dataset with the source data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dataset_client </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> client</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dataset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">scraper_run</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;defaultDatasetId&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="processing-the-data">Processing the data<a href="#processing-the-data" class="hash-link" aria-label="Direct link to Processing the data" title="Direct link to Processing the data">​</a></h3><p>Now, we need to load the data from the dataset to a Pandas dataframe. Pandas supports reading data from a CSV file stream, so we just create a stream with the dataset items in the right format and supply it to <code>pandas.read_csv()</code>.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Load the dataset items into a pandas dataframe</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Parsing weather data...&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dataset_items_stream </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dataset_client</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stream_items</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">item_format</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;csv&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">weather_data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pandas</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read_csv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dataset_items_stream</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> parse_dates</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;datetime&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> date_parser</span><span class="token operator" style="color:#393A34">=</span><span class="token keyword" style="color:#00009f">lambda</span><span class="token plain"> val</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> pandas</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_datetime</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">val</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> utc</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Once we have the data loaded, we can process it. Each data row comes as three fields: <code>datetime</code>, <code>location</code> and <code>temperature</code>. We would like to transform the data so that we have the datetimes in one column, and the temperatures for each location at that datetime in separate columns, one for each location. To achieve this, we use the <code>.pivot()</code> method on the dataframe. Since the temperature varies considerably between day and night, and we would like to get an overview of the temperature trends over a longer period of time, we calculate a rolling average of the temperatures with a 24-hour window.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Transform data to a pivot table for easier plotting</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pivot </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> weather_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pivot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">index</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;datetime&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> columns</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;location&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> values</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;temperature&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mean_daily_temperatures </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pivot</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">rolling</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">window</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;24h&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> min_periods</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">24</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> center</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">mean</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="visualizing-the-data">Visualizing the data<a href="#visualizing-the-data" class="hash-link" aria-label="Direct link to Visualizing the data" title="Direct link to Visualizing the data">​</a></h3><p>With the data processed, we can then make a plot of the results. For that, we use the <code>.plot()</code> method of the dataframe, which creates a figure with the plot, using the Matplotlib library internally. We set the right titles and labels to the plot, and apply some additional formatting to achieve a nicer result.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Create a plot of the data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Plotting the data...&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">axes </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> mean_daily_temperatures</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">plot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">figsize</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">axes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_title</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Weather prediction for holiday destinations&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">axes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_xlabel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">axes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">yaxis</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_major_formatter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">lambda</span><span class="token plain"> val</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">_</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation builtin">int</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">val</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> °C&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">axes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">grid</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">which</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;both&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> linestyle</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;dotted&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">axes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">legend</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">loc</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;best&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">axes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">figure</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tight_layout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As the last step, we need to save the plot to a record in a <a href="/platform/storage/key-value-store">key-value store</a> on the Apify platform, so that we can access it later. We save the rendered figure with the plot to an in-memory buffer, and then save the contents of that buffer to the default key-value store of the actor run through its resource subclient.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Get the resource sub-client for working with the default key-value store of the run</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">key_value_store_client </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> client</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">key_value_store</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">environ</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;APIFY_DEFAULT_KEY_VALUE_STORE_ID&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Save the resulting plot to the key-value store through an in-memory buffer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Saving plot to key-value store...&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> BytesIO</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> buf</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    axes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">figure</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">savefig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buf</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">format</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;png&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dpi</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">200</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> facecolor</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;w&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    buf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">seek</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    key_value_store_client</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_record</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;prediction.png&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> buf</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;image/png&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&#x27;Result is available at </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">os</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">environ</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">[</span><span class="token string-interpolation interpolation string" style="color:#e3116c">&quot;APIFY_API_PUBLIC_BASE_URL&quot;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">]</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&#x27;/v2/key-value-stores/</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">os</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">environ</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">[</span><span class="token string-interpolation interpolation string" style="color:#e3116c">&quot;APIFY_DEFAULT_KEY_VALUE_STORE_ID&quot;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">]</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">/records/prediction.png&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And that&#x27;s it! Now you can save the changes in the editor, and then click <strong>Build and run</strong> at the bottom of the page. The actor will get built, the built actor image will get saved for future re-use, and then it will be executed. You can follow the progress of the actor build and the actor run in the <strong>Last build</strong> and <strong>Last run</strong> tabs, respectively, in the developer console in the actor source view. Once the actor finishes running, it will output the URL where you can access the plot we created in its log.</p><p><img loading="lazy" alt="Building and running the BBC Weather Parser actor" src="/assets/images/bbc-weather-parser-source-bba5d2024e5eb2226931c6804a20eefe.webp" width="2560" height="1958" class="img_ev3q"></p><p>Looking at the results, Honolulu seems like the right choice now, don&#x27;t you think? 🙂</p><p><img loading="lazy" alt="Weather prediction plot created by the BBC Weather Parser actor" src="/assets/images/bbc-weather-prediction-c5e51f95544f9e1faa29081ae8e6dac9.webp" width="2000" height="1000" class="img_ev3q"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/apify/apify-docs-v2/edit/master/sources/academy/tutorials/python/scrape_data_python.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-02-09T13:18:35.000Z">Feb 9, 2023</time></b> by <b>Martin Adámek</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/academy/python"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Python tutorials</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/academy/glossary"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Why a glossary?</div></a></nav><div class="giscus_YLKn"></div></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#exploring-the-bbc-weather-page" class="table-of-contents__link toc-highlight">Exploring the BBC Weather page</a><ul><li><a href="#understanding-the-url-format" class="table-of-contents__link toc-highlight">Understanding the URL format</a></li><li><a href="#determining-the-forecasts-starting-date" class="table-of-contents__link toc-highlight">Determining the forecast&#39;s starting date</a></li><li><a href="#understanding-the-element-structure" class="table-of-contents__link toc-highlight">Understanding the element structure</a></li></ul></li><li><a href="#scraping-the-data-from-the-page" class="table-of-contents__link toc-highlight">Scraping the data from the page</a><ul><li><a href="#setting-up-the-actor" class="table-of-contents__link toc-highlight">Setting up the actor</a></li><li><a href="#writing-the-code" class="table-of-contents__link toc-highlight">Writing the code</a></li><li><a href="#running-the-actor" class="table-of-contents__link toc-highlight">Running the actor</a></li></ul></li><li><a href="#how-to-process-data-in-python-using-pandas" class="table-of-contents__link toc-highlight">How to process data in Python using Pandas</a></li><li><a href="#processing-previously-scraped-data" class="table-of-contents__link toc-highlight">Processing previously scraped data</a><ul><li><a href="#setting-up-the-actor" class="table-of-contents__link toc-highlight">Setting up the actor</a></li><li><a href="#scraping-the-data" class="table-of-contents__link toc-highlight">Scraping the data</a></li><li><a href="#processing-the-data" class="table-of-contents__link toc-highlight">Processing the data</a></li><li><a href="#visualizing-the-data" class="table-of-contents__link toc-highlight">Visualizing the data</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer_wSZr light"><div class="container padding-horiz--lg"><div class="row" style="justify-content:space-between"><div class="col col--2"><div class="footerTitle_Fgq2">Learn</div><ul class="clean-list"><li class="footer__item"><a href="https://docs.apify.com/academy" target="_self" rel="dofollow" class="footer__link-item">Academy</a></li><li class="footer__item"><a href="https://docs.apify.com/platform" target="_self" rel="dofollow" class="footer__link-item">Platform</a></li></ul></div><div class="col col--2"><div class="footerTitle_Fgq2">API</div><ul class="clean-list"><li class="footer__item"><a href="https://docs.apify.com/api/v2/" target="_self" rel="dofollow" class="footer__link-item">Reference</a></li><li class="footer__item"><a href="https://docs.apify.com/api/client/js/" target="_self" rel="dofollow" class="footer__link-item">Client for JavaScript</a></li><li class="footer__item"><a href="https://docs.apify.com/api/client/python/" target="_self" rel="dofollow" class="footer__link-item">Client for Python</a></li></ul></div><div class="col col--2"><div class="footerTitle_Fgq2">SDK</div><ul class="clean-list"><li class="footer__item"><a href="https://docs.apify.com/sdk/js/" target="_self" rel="dofollow" class="footer__link-item">SDK for JavaScript</a></li><li class="footer__item"><a href="https://docs.apify.com/sdk/python/" target="_self" rel="dofollow" class="footer__link-item">SDK for Python (beta)</a></li></ul></div><div class="col col--2"><div class="footerTitle_Fgq2">Other</div><ul class="clean-list"><li class="footer__item"><a href="https://docs.apify.com/cli/" target="_self" rel="dofollow" class="footer__link-item" position="left">CLI</a></li></ul></div><div class="col col--2"><div class="footerTitle_Fgq2">More</div><ul class="clean-list"><li class="footer__item"><a href="https://crawlee.dev" target="_blank" rel="dofollow" class="footer__link-item">Crawlee</a></li><li class="footer__item"><a href="https://github.com/apify" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="row padding-vert--md padding-top--lg"><div class="col padding-vert--md col--6"><div class="footerLogo_yvY1"></div></div></div></div></footer></div></div>
<script src="/assets/js/runtime~main.59ce9323.js"></script>
<script src="/assets/js/main.6eff774b.js"></script>
</body>
</html>